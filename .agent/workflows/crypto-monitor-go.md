---
description: í¬ë¦½í† ëª¨ë‹ˆí„°(CryptoMonitor) Go í”„ë¡œì íŠ¸ í‘œì¤€ ê°œë°œ ì›Œí¬í”Œë¡œìš°
---

# í¬ë¦½í† ëª¨ë‹ˆí„° Go ê°œë°œ ì›Œí¬í”Œë¡œìš° (Workflow)

ì´ ë¬¸ì„œëŠ” AI ì—ì´ì „íŠ¸ì™€ í˜ì–´ í”„ë¡œê·¸ë˜ë° ì‹œ ì¼ê´€ëœ í’ˆì§ˆê³¼ í”„ë¡œì íŠ¸ êµ¬ì¡°ë¥¼ ìœ ì§€í•˜ê¸° ìœ„í•œ í•µì‹¬ ê°€ì´ë“œë¼ì¸ì„ ì •ì˜í•©ë‹ˆë‹¤.

---

## í•µì‹¬ ê°œë°œ ì›ì¹™ (Core Principles)

1. **ìƒíƒœ ê´€ë¦¬ì˜ ìˆ˜ë™ ê¸ˆì§€ (No Manual State)**
   - ëª¨ë“  ìƒíƒœ ë³€í™”ëŠ” ì •ì˜ëœ ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ì„œë§Œ ì´ë£¨ì–´ì ¸ì•¼ í•˜ë©°, ì „ì—­ ë³€ìˆ˜ ì‚¬ìš©ì„ ì§€ì–‘í•œë‹¤.
2. **ì›ìì  í•¨ìˆ˜ (Atomic Functions)**
   - í•˜ë‚˜ì˜ í•¨ìˆ˜ëŠ” í•˜ë‚˜ì˜ ëª…í™•í•œ ì‘ì—…ë§Œ ìˆ˜í–‰í•˜ë©°, ì ì ˆí•œ ê¸¸ì´ë¥¼ ìœ ì§€í•˜ì—¬ AIì˜ ì»¨í…ìŠ¤íŠ¸ í•œë„ ë¶€ë‹´ì„ ì¤„ì¸ë‹¤.
3. **í‘œì¤€í™”ëœ ì£¼ì„ íŒ¨í„´ (Standardized Comments)**
   - ëª¨ë“  ì¤‘ìš” ë¡œì§ê³¼ í•¨ìˆ˜ì—ëŠ” ì •ê·œí™”ëœ ì£¼ì„ì„ ë‹¬ì•„ AIê°€ RAG ë° ì½”ë“œ ë¶„ì„ ì‹œ ì •í™•í•œ ë©”íƒ€ë°ì´í„°ë¥¼ ì–»ê²Œ í•œë‹¤.
4. **ê²°í•©ë„ ë¶„ë¦¬ (Decoupling)**
   - ì¸í„°í˜ì´ìŠ¤ë¥¼ ì ê·¹ í™œìš©í•˜ì—¬, AIê°€ ì „ì²´ ì‹œìŠ¤í…œì„ ê±´ë“œë¦¬ì§€ ì•Šê³ ë„ íŠ¹ì • ëª¨ë“ˆë§Œ ì •í™•íˆ êµì²´í•  ìˆ˜ ìˆê²Œ í•œë‹¤.

## ì½”ë“œ í’ˆì§ˆ 4ëŒ€ ì›ì¹™ (Standard)
- **ë‚®ì€ ê²°í•©ë„**: ëª¨ë“ˆ ê°„ ì˜ì¡´ì„± ìµœì†Œí™”, ì¸í„°í˜ì´ìŠ¤ë¡œ ì†Œí†µ.
- **ë†’ì€ ì‘ì§‘ë„**: í•˜ë‚˜ì˜ ëª¨ë“ˆì€ í•˜ë‚˜ì˜ ì±…ì„ë§Œ(SRP).
- **ëª…í™•í•œ ë ˆì´ì–´**: Domain, Service, Infra, UI ë“± ê³„ì¸µ ì—„ê²© ë¶„ë¦¬.
- **ì¼ê´€ëœ íŒ¨í„´**: ì „ì²´ í”„ë¡œì íŠ¸ì—ì„œ ë™ì¼í•œ êµ¬í˜„ ë°©ì‹ê³¼ ë„¤ì´ë° ìœ ì§€.

---

## í™˜ê²½ ì„¤ì • ë° ì‹¤í–‰ (Getting Started)

```bash
# 1. ëª¨ë“ˆ ì˜ì¡´ì„± ë‹¤ìš´ë¡œë“œ
go mod download

# 2. ë¡œì»¬ ì„¤ì • íŒŒì¼ ì¤€ë¹„ (ìƒ˜í”Œ ë³µì‚¬ í›„ ì‹¤ì œ ì •ë³´ ì…ë ¥)
cp configs/config.example.yaml configs/config.yaml

# 3. ë¹Œë“œ ë° ì‹¤í–‰
go build -o cryptomonitor ./cmd/app
./cryptomonitor
```

## í•„ìˆ˜ ì ˆì°¨

### ê°œë°œ ì „ (Before Coding)
1. `CHANGELOG.md` í™•ì¸ - ìµœê·¼ ë³€ê²½ ì‚¬í•­
2. `API_REFERENCE.md` í™•ì¸ - í˜„ì¬ ë„ë©”ì¸ í•¨ìˆ˜ êµ¬ì¡°
3. **ë‹¨ê³„ì  ê°œë°œ (Incremental Development)**: í•œ ë²ˆì— ë°©ëŒ€í•œ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ì§€ ì•Šê³ , ê²€ì¦ ê°€ëŠ¥í•œ ë‹¨ìœ„ë¡œ ë‚˜ëˆ„ì–´ ì½”ë”© ë° í™•ì¸.

### ê°œë°œ í›„ (After Coding)
// turbo-all
4. `go mod tidy` ìˆ˜í–‰ (ì˜ì¡´ì„± ì •ë¦¬)
5. `go fmt ./...` ìˆ˜í–‰ (ì½”ë“œ ìŠ¤íƒ€ì¼ êµì •)
6. `go vet ./...` ìˆ˜í–‰ (ì •ì  ë¶„ì„)
7. `go test ./...` ìˆ˜í–‰ (ìœ ë‹› í…ŒìŠ¤íŠ¸ í•„ìˆ˜ í†µê³¼ âœ…)
8. `go build ./...` ìˆ˜í–‰ (ìµœì¢… ë¹Œë“œ ê²€ì¦)
9. `CHANGELOG.md` ì—…ë°ì´íŠ¸
10. `API_REFERENCE.md` ì—…ë°ì´íŠ¸ (ìƒˆ ë„ë©”ì¸ í•¨ìˆ˜ ì¶”ê°€ ì‹œ)

---

## ì½”ë”© ê·œì¹™

### ë³´ì•ˆ ë° íƒ„íƒ„í•œ ì„¤ê³„ (Security & Resilience) ğŸ›¡ï¸
- **ë³µì›ë ¥ (Resilience)**: WebSocket/API ì—°ê²° ì‹¤íŒ¨ ì‹œ Panicì„ ê¸ˆì§€í•˜ë©°, **ì§€ìˆ˜ ë°±ì˜¤í”„(Exponential Backoff)** ì•Œê³ ë¦¬ì¦˜ì„ í†µí•œ ìë™ ì¬ì—°ê²° ë¡œì§ì„ í•„ìˆ˜ êµ¬í˜„í•œë‹¤.
- **ë¹„ë°€ ì •ë³´ ê´€ë¦¬ (Secrets Management)**: 
  - API Key ë“±ì˜ ë¯¼ê° ì •ë³´ëŠ” ì†ŒìŠ¤ì½”ë“œë‚˜ ì›ê²©ì— ì—…ë¡œë“œë˜ëŠ” ì„¤ì • íŒŒì¼(`config.yaml`)ì— í¬í•¨í•˜ì§€ ì•ŠëŠ”ë‹¤.
  - **í™˜ê²½ ë³€ìˆ˜ ìš°ì„  ìˆœìœ„**: í…ŒìŠ¤íŠ¸ í™˜ê²½ì´ë‚˜ ë³´ì•ˆì„ ìœ„í•´ í™˜ê²½ ë³€ìˆ˜ `CRYPTO_UPBIT_KEY` ë“±ì„ í†µí•´ ì£¼ì…ë°›ëŠ” ë°©ì‹ì„ ìµœìš°ì„ ìœ¼ë¡œ í•˜ë©°, ì½”ë“œì—ì„œ ìë™ ê°ì§€í•˜ì—¬ ì˜¤ë²„ë¼ì´ë“œí•˜ê²Œ í•œë‹¤.
- **í…ŒìŠ¤íŠ¸ ê°•ì œ (Test-Driven)**: íŠ¹íˆ `Domain` ê³„ì¸µì˜ ìˆ˜ì‹ ë° ê³„ì‚° ë¡œì§ì€ ë°˜ë“œì‹œ ìœ ë‹› í…ŒìŠ¤íŠ¸(`*_test.go`)ë¥¼ ë™ë°˜í•˜ì—¬ ìˆ«ìì˜ ë¬´ê²°ì„±ì„ ê²€ì¦í•´ì•¼ í•œë‹¤.

### ê°œë°œ ê°€ì´ë“œ (Best Practices)

1. **Decimal ì—°ì‚° ì±…ì„**
   - **Infra Layer**: ë°ì´í„° ìˆ˜ì§‘ ë° íŒŒì‹±(`string` -> `Decimal`) ë‹´ë‹¹.
   - **Domain/Service Layer**: ê°€ê²© í”„ë¦¬ë¯¸ì—„ ë“± ëª¨ë“  ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ê³„ì‚° ìˆ˜í–‰.

2. **êµ¬ì¡°í™”ëœ ë¡œê¹… (Structured Logging)**
   - ëª¨ë“  ë¡œê·¸ ì¶œë ¥ì€ Go 1.21 í‘œì¤€ì¸ `slog`ë¥¼ ì‚¬ìš©í•˜ë©°, ë‹¨ìˆœíˆ ë©”ì‹œì§€ë§Œ ë‚¨ê¸°ì§€ ì•Šê³  `slog.String("symbol", symbol)` ë“± ë¬¸ë§¥ ì •ë³´(Context)ë¥¼ JSON í•„ë“œë¡œ í¬í•¨í•œë‹¤.
   - `main.go`ì˜ ì„¤ì •ê°’(`logging.level`)ê³¼ ì—°ë™í•˜ì—¬ ì‹¤í–‰ ì¤‘ ë¡œê·¸ ìƒì„¸ë„ë¥¼ ì œì–´í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.

3. **ì—ëŸ¬ ì²˜ë¦¬ (Error Wrapping & Retryability)**
   - **ì—ëŸ¬ ë˜í•‘**: `fmt.Errorf("context: %w", err)`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—ëŸ¬ì˜ ë°œìƒ ì§€ì ê³¼ ì›ë³¸ ì—ëŸ¬ ì •ë³´ë¥¼ ëª¨ë‘ ë³´ì¡´í•œë‹¤.
   - **ì¬ì‹œë„ ì „ëµ**: `internal/domain/errors.go`ì˜ `RetriableError` ì¸í„°í˜ì´ìŠ¤ë¥¼ í™œìš©í•˜ì—¬, ì¼ì‹œì ì¸ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ì™€ ì¹˜ëª…ì ì¸ ë¡œì§ ì˜¤ë¥˜ë¥¼ êµ¬ë¶„í•´ ëŒ€ì‘í•œë‹¤.

4. **Config ë¶ˆë³€ì„±**
   - ì„¤ì •ì€ ì‹œì‘ ì‹œ ë¡œë“œë˜ë©°, ì´í›„ ì‹¤í–‰ ì¤‘ì—ëŠ” ìˆ˜ì •ë˜ì§€ ì•ŠëŠ”ë‹¤ (Read-Only).

### ëª…ëª… ê·œì¹™
- **íŒ¨í‚¤ì§€ëª…**: ì†Œë¬¸ì (ì˜ˆ: `priceservice` ë³´ë‹¤ëŠ” `service` ê¶Œì¥)
- **íƒ€ì…ëª…**: PascalCase (ì˜ˆ: `MarketData`, `Ticker`)
- **í•¨ìˆ˜ëª…**: PascalCase (exported), camelCase (unexported)
- **íŒŒì¼ëª…**: `snake_case.go` (ì˜ˆ: `upbit_worker.go`)

---

## ë¡œë“œë§µ (Logic First)

> GUI ì „ì— ì½˜ì†”ì—ì„œ ë¡œì§ ê²€ì¦ ìš°ì„ 

### Phase 1: ê¸°ë°˜ êµ¬ì¶• âœ…
- [x] Domain (`Ticker`, `MarketData`, `AlertConfig`)
- [x] Service (`PriceService`)
- [x] ì—ëŸ¬/ë¡œê¹… í‘œì¤€ ìˆ˜ë¦½

### Phase 2: WebSocket Infra êµ¬í˜„ âœ…
- [x] `upbit_worker.go` - ì§€ìˆ˜ ë°±ì˜¤í”„ ì¬ì—°ê²°
- [x] `bitget_types.go` - ê³µí†µ íƒ€ì…/ìƒìˆ˜
- [x] `bitget_spot.go` - í˜„ë¬¼ WebSocket
- [x] `bitget_futures.go` - ì„ ë¬¼ WebSocket (í€ë”©ë¹„)

### Phase 3: í™˜ìœ¨ ë° ì—°ì‚° ê³ ë„í™” âœ…
- [x] Dunamu í™˜ìœ¨ API ì—°ë™
- [x] ê¹€í”„ ì‹¤ì‹œê°„ ê³„ì‚° ê²€ì¦ (`calculatePremium`)

### Phase 4: UI êµ¬í˜„
- [ ] Fyne/Wails ì„ íƒ ë° êµ¬í˜„

---

## ì„¤ê³„ ì›ì¹™ ì¶”ê°€ (2026-01-03)

1. **API ìŠ¤í™ ì¤€ìˆ˜**: ê° ê±°ë˜ì†Œ API ë¬¸ì„œì—ì„œ ê¶Œì¥í•˜ëŠ” ìë£Œí˜•ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©
   - ì—…ë¹„íŠ¸: `Double` â†’ Go `float64`
   - ë¹„íŠ¸ê²Ÿ: `String` â†’ Go `string`
   - ë‚´ë¶€ ì—°ì‚° ì‹œì—ë§Œ `decimal.Decimal`ë¡œ ë³€í™˜

